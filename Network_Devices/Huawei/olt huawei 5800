zabbix_export:
  version: '6.0'
  date: '2023-06-28T11:54:05Z'
  groups:
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    - uuid: e1875eafff3d4198bdd1e8e7689aa925
      template: 'OLT Huawei'
      name: 'OLT Huawei'
      groups:
        - name: Templates
      items:
        - uuid: 80360937ebeb407ba06258c8ea7819ed
          name: Uptime
          type: SNMP_AGENT
          snmp_oid: 'DISMAN-EVENT-MIB::sysUpTimeInstance'
          key: 1.3.6.1.2.1.1.3
          delay: 20m
          history: 10d
          trends: 35d
          value_type: FLOAT
          units: h
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  value = ((value / 60)/60)/100;
                  teste = Math.round(value);
                  return (parseFloat(teste));
          tags:
            - tag: application
              value: uptime
          triggers:
            - uuid: be19b646c7f84297a34b98d85440a1dd
              expression: 'last(/OLT Huawei/1.3.6.1.2.1.1.3)=0'
              name: 'OLT Reiniciou'
              priority: HIGH
              tags:
                - tag: trigger
                  value: reboot_olt
        - uuid: 057473e468f643edba88a52c25d320b8
          name: 'Onus Aguardando Configuração'
          type: EXTERNAL
          key: 'desprovisionadas.sh[{$SNMP_COMMUNITY},{HOST.CONN]'
          delay: 5m
          history: 7d
          trends: 15d
          value_type: FLOAT
          tags:
            - tag: application
              value: onu_uncfg
        - uuid: 25f83bb4b3d74a4788f3fd4656224f5c
          name: 'Number of network interfaces'
          type: SNMP_AGENT
          snmp_oid: 'IF-MIB::ifNumber.0'
          key: ifNumber
          delay: '60'
          history: 7d
          description: 'The number of network interfaces (regardless of their current state) present on this system.'
          tags:
            - tag: Application
              value: Interfaces
        - uuid: e72893a5cb624700bbf9e0ee04cfe58f
          name: 'Total Onus OffLine teste count'
          type: CALCULATED
          key: total_onu_off
          delay: 10s
          history: 10d
          trends: 35d
          status: DISABLED
          value_type: FLOAT
          params: 'count(last_foreach(/OLT Huawei Mensal/Ontstatus[*]))=1'
          tags:
            - tag: application
              value: total_onus_Offline_olt
        - uuid: 7cde49c4a257472693b88d9897217eaa
          name: 'Total Onus OffLine'
          type: EXTERNAL
          key: 'total_onu_off.sh[{$SNMP_COMMUNITY},{HOST.CONN},2]'
          delay: 2m
          history: 10d
          trends: 35d
          tags:
            - tag: application
              value: total_onus_Offline_olt
          triggers:
            - uuid: 81c08b5f52964273a7e64d344af1fa15
              expression: 'last(/OLT Huawei/total_onu_off.sh[{$SNMP_COMMUNITY},{HOST.CONN},2])>(avg(/OLT Huawei/total_onu_off.sh[{$SNMP_COMMUNITY},{HOST.CONN},2],3) * 1.5)'
              name: 'Queda massiva onus'
              priority: HIGH
        - uuid: 86e40cd65a104b30b8b7e0c986a62d9a
          name: 'Total Onus Online'
          type: EXTERNAL
          key: 'total_onu_on.sh[{$SNMP_COMMUNITY},{HOST.CONN},1]'
          delay: 2m
          history: 10d
          trends: 35d
          tags:
            - tag: application
              value: total_onus_Online_olt
      discovery_rules:
        - uuid: 8901bd96f7564b0c8e61e1fa3894fbf9
          name: 'OLT Placas'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#OLTBOARD},1.3.6.1.4.1.2011.6.3.3.2.1.1]'
          key: hwSlotIndex
          delay: 10s
          item_prototypes:
            - uuid: 40156b3ba4be4942a32911fe01b4764d
              name: 'Board {#OLTBOARD} temperatura'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.3.3.2.1.13.{#SNMPINDEX}'
              key: 'OltBoardCpuTemp[{#SNMPINDEX}]'
              delay: 60s
              history: 15d
              trends: 35d
              units: ºC
              preprocessing:
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: application
                  value: OLT_HW_temperatura
              trigger_prototypes:
                - uuid: dfb7271a3a3440b1b0b77f92a32f2fb8
                  expression: 'avg(/OLT Huawei/OltBoardCpuTemp[{#SNMPINDEX}],20m)>(avg(/OLT Huawei/OltBoardCpuTemp[{#SNMPINDEX}],3) * 1.5)'
                  name: 'Board {#OLTBOARD} aumento 50% temperatura'
                - uuid: 02f2d983e87f4a6aa6215f90378c389f
                  expression: 'avg(/OLT Huawei/OltBoardCpuTemp[{#SNMPINDEX}],20m)>=60'
                  name: 'Board {#OLTBOARD} temperatura limite'
            - uuid: 3609a458a4fd446c9ba99c2ff3fe9282
              name: 'Olt CPU util board {#OLTBOARD}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.2.6.7.1.1.2.1.5.{#SNMPINDEX}'
              key: 'OltCpuUtilBoard[{#SNMPINDEX}]'
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: '%'
              tags:
                - tag: application
                  value: OLT_HW_cpu%
            - uuid: f7fe2b101f014208bc8904af24c1f60f
              name: 'Olt Memoria util board {#OLTBOARD}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.2.6.7.1.1.2.1.6.{#SNMPINDEX}'
              key: 'OltmemoriaUtilBoard[{#SNMPINDEX}]'
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: '%'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == -1 ){
                       value = 0;
                      }
                      return (parseFloat(value));
              tags:
                - tag: application
                  value: OLT_HW_memoria%
          graph_prototypes:
            - uuid: 6712e928271140859db5bcb509ddb294
              name: 'Board {#OLTBOARD} temperatura'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'OltBoardCpuTemp[{#SNMPINDEX}]'
        - uuid: 9a2e4b8b9c014ac58d3ffcabf610af6d
          name: 'Network interfaces'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},IF-MIB::ifName]'
          key: ifName
          delay: '30'
          description: |
            You may also consider using IF-MIB::ifType or IF-MIB::ifAlias for discovery depending on your filtering needs.
            
            {$SNMP_COMMUNITY} is a global macro.
          item_prototypes:
            - uuid: b05540d623fd4c95908c5e66b208c3c1
              name: 'Upload Restante Porta {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.21.1.7.{#SNMPINDEX}'
              key: 'hwGponDeviceOltControlLeftBandWidth[{#SNMPVALUE}]'
              delay: 20m
              history: 7d
              trends: 35d
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: Application
                  value: hwGponDeviceOltControlLeftBandWidth
            - uuid: 31de5d84ae52481ebdfa8b79436d9075
              name: 'Admin status of interface {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifAdminStatus.{#SNMPINDEX}'
              key: 'ifAdminStatus[{#SNMPVALUE}]'
              delay: '60'
              history: 7d
              trends: 35d
              description: 'The desired state of the interface.'
              valuemap:
                name: 'SNMP interface status (ifAdminStatus)'
              tags:
                - tag: Application
                  value: Interfaces
            - uuid: 9535a3367fb3489da204ba9faabc3fd1
              name: 'Incoming traffic on interface {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'ifInOctets[{#SNMPVALUE}]'
              delay: '10'
              history: 7d
              trends: 35d
              units: bps
              description: 'The number of octets in valid MAC frames received on this interface, including the MAC header and FCS.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Application
                  value: Interfaces
            - uuid: 2bf4992949bc454f9da7ad97071c6239
              name: 'Name of interface {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifName.{#SNMPINDEX}'
              key: 'ifName[{#SNMPVALUE}]'
              delay: '3600'
              history: 7d
              trends: '0'
              value_type: CHAR
              tags:
                - tag: Application
                  value: Interfaces
            - uuid: d5ab8a78b6fe4f7fadd1deca56cc2985
              name: 'Operational status of interface {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'ifOperStatus[{#SNMPVALUE}]'
              delay: '60'
              history: 7d
              trends: 35d
              description: 'The current operational state of the interface.'
              valuemap:
                name: 'SNMP interface status (ifOperStatus)'
              tags:
                - tag: Application
                  value: Interfaces
              trigger_prototypes:
                - uuid: e3214b8185cf4b11971c0897836e7a93
                  expression: '(last(/OLT Huawei/ifOperStatus[{#SNMPVALUE}],#1)<>last(/OLT Huawei/ifOperStatus[{#SNMPVALUE}],#2))=1'
                  name: 'Operational status was changed on {HOST.NAME} interface {#SNMPVALUE}'
                  priority: INFO
            - uuid: c0e2bb32d05b4acda64b8fe25a49528c
              name: 'Outgoing traffic on interface {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'ifOutOctets[{#SNMPVALUE}]'
              delay: '10'
              history: 7d
              trends: 35d
              units: bps
              description: 'The number of octets transmitted in MAC frames on this interface, including the MAC header and FCS.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Application
                  value: Interfaces
          graph_prototypes:
            - uuid: 2684e4ea80764b488867c2a36f96b75c
              name: 'Traffic on interface {#SNMPVALUE}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 00AA00
                  item:
                    host: 'OLT Huawei'
                    key: 'ifInOctets[{#SNMPVALUE}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 3333FF
                  item:
                    host: 'OLT Huawei'
                    key: 'ifOutOctets[{#SNMPVALUE}]'
        - uuid: 8caa2a35be5648f6afac754b48ae838f
          name: 'OLT IFName ETH'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#OLTPORT},ifName]'
          key: olt_ifname_ethernet
          delay: 60s
          filter:
            conditions:
              - macro: '{#OLTPORT}'
                value: ^ethernet
                formulaid: A
          item_prototypes:
            - uuid: fd8d4b0af05f434695325c1ee1999668
              name: 'Port State offline reason {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.14.1.4.1.33.{#SNMPINDEX}'
              key: 'hwifEthernetOfflineReason[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              description: |
                Indicates the offline reason of ethernet port.
                Options:
                1. invalid(-1)                        -invalid value 
                2. unknown(1)                         -unknown
                3. boardabnormal(2)                   -board abnormal
                4. opticalmoduleoffline(3)            -optical module offline
                5. los(4)                             -LOS detected                                      
                6. shutdownbyuser(5)                  -port shuted down by user
                7. ringdetected(6)                    -ring detected
                8. ethoamtriggeredlinkdown(7)         -ETHOAM triggered link down 
                9. dyinggasp(8)                       -peer end loss of power
              valuemap:
                name: 'Indicates the offline reason of ethernet port.'
              tags:
                - tag: application
                  value: 'uplink port offline reason'
            - uuid: 7909425f000e46d19ec741c2d715f649
              name: 'Uplink RX {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.14.6.4.1.5.{#SNMPINDEX}'
              key: 'hwifEthernetOpticModuleRX[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
              tags:
                - tag: application
                  value: 'uplink port RX'
            - uuid: df614d4ec1654315b182934ae2f03f65
              name: 'Uplink Port State {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.14.1.4.1.38.{#SNMPINDEX}'
              key: 'hwifEthernetOpticModuleState[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              description: |
                Indicates the state of optical module.
                Options:
                1. normal(1)
                2. absent(2)
                3. abnormal(3)
                4. mismatch(4)
                '2147483647' means invalid value.
              tags:
                - tag: application
                  value: 'uplink port state'
              trigger_prototypes:
                - uuid: 196fe086c06648959df6764432e76ab2
                  expression: 'last(/OLT Huawei/hwifEthernetOpticModuleState[{#OLTPORT}])<>1 and (last(/OLT Huawei/hwifEthernetOpticModuleState[{#OLTPORT}],#1)<>last(/OLT Huawei/hwifEthernetOpticModuleState[{#OLTPORT}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/OLT Huawei/hwifEthernetOpticModuleState[{#OLTPORT}])=1'
                  name: 'Uplink Port State {#OLTPORT}: Down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: INFO
                  tags:
                    - tag: application
                      value: uplink_down
            - uuid: bcfae21c006a41e0a0cb2d82c560a747
              name: 'Uplink TX {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.14.6.4.1.4.{#SNMPINDEX}'
              key: 'hwifEthernetOpticModuleTX[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
              tags:
                - tag: application
                  value: 'uplink port TX'
            - uuid: 3400051665af4dabadd6c1d78dc4fdb4
              name: 'Speed Port State {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.14.1.4.1.3.{#SNMPINDEX}'
              key: 'hwifEthernetSpeed[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: GB
              description: |
                thernet port rate.
                Options:
                1. auto(0)             -Ethernet port rate 0
                2. s10M(10)            -Ethernet port rate forced 10M  
                3. s100M(100)          -Ethernet port rate forced 100M
                4. s1000M(1000)        -Ethernet port rate forced 1000M
                5. s2500M(2500)        -Ethernet port rate forced 2500M
                6. s10000M(10000)      -Ethernet port rate forced 10000M
                7. s100000M(100000)    -Ethernet port rate forced 100000M
                8. autoS10M(11)        -Ethernet port rate auto 10M
                9. autoS100M(101)      -Ethernet port rate auto 100M
                10. autoS1000M(1001)   -Ethernet port rate auto 1000M
                11. autoS10000M(10001) -Ethernet port rate auto 10000M
                12. invalid(-1)        -invalid value
                The basic principle for configuring the Ethernet port rate is that the rates of the corresponding
                ports on two interconnected devices must be the same, thus preventing communication failure.
                The FE optical port supports only the port rate of 100 Mbit/s.
                The GE optical port supports the port rates of 1000Mbit/s and 2500 Mbit/s.
                The 10GE optical port supports only the port rate of 10000 Mbit/s.
                The 100GE optical port supports only the port rate of 100000 Mbit/s.
                The GE electrical ports support the port rates of 10 Mbit/s, 100 Mbit/s, and 1000 Mbit/s and auto-negotiation.
                Only when the auto-negotiation is disabled on a port, rate configuration can be set.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: application
                  value: 'uplink port speed'
              trigger_prototypes:
                - uuid: 2824240d9a2a4f47a9e80dcf43a7641e
                  expression: 'change(/OLT Huawei/hwifEthernetSpeed[{#OLTPORT}])<>last(/OLT Huawei/hwifEthernetSpeed[{#OLTPORT}])'
                  name: 'Port Speed Change {#OLTPORT}'
                  priority: WARNING
                  tags:
                    - tag: application
                      value: 'port speed change'
            - uuid: f838e189519f45a68b19ea33f54a22e2
              name: 'Temperatura Porta Uplink {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.14.6.4.1.1.{#SNMPINDEX}'
              key: 'hwOpticsTemperature[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: ºC
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              tags:
                - tag: application
                  value: 'temperatura porta uplink'
            - uuid: 6f9a2292a4a4440c9525b59062eb5e61
              name: 'MAX Temperature alarm threshold {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: 'SNMPv2-SMI::enterprises.2011.5.14.6.9.1.6.{#SNMPINDEX}'
              key: 'MAXTemperaturealarmthreshold[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: ºC
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              tags:
                - tag: application
                  value: 'MAX Temperature alarm threshold'
            - uuid: 9984bb5fa0ed46e78bc0c27dbf018a69
              name: 'MX TX/Rx power alarm threshold(dBm) {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: 'SNMPv2-SMI::enterprises.2011.5.14.6.9.1.2.{#SNMPINDEX}'
              key: 'MaxTX_Rxpoweralarmthreshold[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
              tags:
                - tag: application
                  value: 'MIN TX Rx power alarm threshold(dBm)'
            - uuid: 55353d4043c04b5f879ad1401f01c2a8
              name: 'MIN Rx power alarm threshold(dBm) {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: 'SNMPv2-SMI::enterprises.2011.5.14.6.9.1.4.{#SNMPINDEX}'
              key: 'MINRxpoweralarmthreshold[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
              tags:
                - tag: application
                  value: 'MIN Rx power alarm threshold(dBm)'
            - uuid: 6ec6c1b641644866b2c828077ccdcf37
              name: 'MIN Temperature alarm threshold {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: 'SNMPv2-SMI::enterprises.2011.5.14.6.9.1.5.{#SNMPINDEX}'
              key: 'MINTemperaturealarmthreshold[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: ºC
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
                - type: IN_RANGE
                  parameters:
                    - '-30'
                    - '20'
              tags:
                - tag: application
                  value: 'MIN Temperature alarm threshold'
            - uuid: c33a683aeeb043d89a0b81fa899d23d3
              name: 'MIN Tx power alarm threshold(dBm) {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: 'SNMPv2-SMI::enterprises.2011.5.14.6.9.1.1.{#SNMPINDEX}'
              key: 'MINTxpoweralarmthreshold[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseFloat(value) * 0.000001;
                      return (parseFloat(value).toFixed(2))
              tags:
                - tag: application
                  value: 'MIN Tx power alarm threshold(dBm)'
          trigger_prototypes:
            - uuid: 853ed08ccd744c6b805cb86b44ef7d6f
              expression: 'avg(/OLT Huawei/hwOpticsTemperature[{#OLTPORT}],1)>(last(/OLT Huawei/MAXTemperaturealarmthreshold[{#OLTPORT}]) * 0.8)'
              name: 'Temperatura 80% do limite Uplink {#OLTPORT}'
              priority: WARNING
              tags:
                - tag: application
                  value: temperatura_80%_uplink
          graph_prototypes:
            - uuid: 630f1f08bd9f46d491cd0a084d5ea4b8
              name: 'Speed Port State {#OLTPORT}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'hwifEthernetSpeed[{#OLTPORT}]'
            - uuid: 95c9574ef26640938d9b71662e53f49a
              name: 'Temperatura {#OLTPORT}'
              graph_items:
                - drawtype: BOLD_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'MAXTemperaturealarmthreshold[{#OLTPORT}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: 29B6F6
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'MINTemperaturealarmthreshold[{#OLTPORT}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'hwOpticsTemperature[{#OLTPORT}]'
            - uuid: e775d535bc554de49846c9e66f7eec27
              name: 'Uplink Porta TX/RX {#OLTPORT}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'hwifEthernetOpticModuleRX[{#OLTPORT}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'hwifEthernetOpticModuleTX[{#OLTPORT}]'
                - sortorder: '2'
                  drawtype: BOLD_LINE
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'MINRxpoweralarmthreshold[{#OLTPORT}]'
                - sortorder: '3'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'MINTxpoweralarmthreshold[{#OLTPORT}]'
                - sortorder: '4'
                  drawtype: BOLD_LINE
                  color: F7941D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'MaxTX_Rxpoweralarmthreshold[{#OLTPORT}]'
        - uuid: 1d22cbe4685042e38c9ae8202d341fb5
          name: 'OLT IFName GPON'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#OLTPORT},ifName]'
          key: olt_pcb
          delay: 10s
          filter:
            conditions:
              - macro: '{#OLTPORT}'
                value: ^GPON
                formulaid: A
          item_prototypes:
            - uuid: c1e4d64df012458fa5d33022201cdfbf
              name: 'Gpon Port State {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.21.1.10.{#SNMPINDEX}'
              key: 'OltLinktState[{#OLTPORT}]'
              delay: 20s
              history: 15d
              trends: 35d
              value_type: FLOAT
              description: |
                1 - link
                2 - down
              valuemap:
                name: 'SNMP interface status (ifAdminStatus)'
              tags:
                - tag: application
                  value: 'Gpon Port state'
              trigger_prototypes:
                - uuid: 8891f4c86ab04487b9fe57586276d8e2
                  expression: '(last(/OLT Huawei/OltLinktState[{#OLTPORT}],#1)<>last(/OLT Huawei/OltLinktState[{#OLTPORT}],#2))=2'
                  name: 'Interface status changed {#OLTPORT} - link down'
                  priority: AVERAGE
            - uuid: 997bb57e4f9a4847bd54b2e4cc1dd8f5
              name: 'Onus por PON {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.21.1.16.{#SNMPINDEX}'
              key: 'onuconfigpon[{#OLTPORT}]'
              delay: 5m
              history: 15d
              trends: 35d
              value_type: FLOAT
              description: 'total de onu configuradas na porta pon'
              tags:
                - tag: application
                  value: _onu_por_pon
            - uuid: d00d6b720d8542bf9041a0431ad8fde8
              name: 'Total ONUs Online por PON {#OLTPORT}'
              type: EXTERNAL
              key: 'pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},1]'
              history: 15d
              trends: 35d
              value_type: FLOAT
              tags:
                - tag: application
                  value: onu_online_porta_pon
              trigger_prototypes:
                - uuid: b7c525c8f4ca4e7fa3b16b49418cdd4b
                  expression: 'last(/OLT Huawei/pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},1])<(avg(/OLT Huawei/pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},1],1) * 0.5 )'
                  name: 'Queda 50% onus ONLINE {#OLTPORT}'
                  priority: HIGH
                  tags:
                    - tag: trigger
                      value: queda_50%_onu_online
            - uuid: 4207bebea9564297aa899b9e892e6a40
              name: 'Total ONUs Offline por PON {#OLTPORT}'
              type: EXTERNAL
              key: 'pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},2]'
              history: 15d
              trends: 35d
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return value'
              tags:
                - tag: application
                  value: onu_offline_porta
            - uuid: ea2f53d192b7441eb93e8faa75a66ef3
              name: 'Temperatura Porta PON {#OLTPORT}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.23.1.1.{#SNMPINDEX}'
              key: 'tempportapon[{#OLTPORT}]'
              delay: 60s
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: ºC
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 2147483647){
                      value = 0
                      }
                      return value
              tags:
                - tag: application
                  value: 'temperatura porta pon'
              trigger_prototypes:
                - uuid: db4b10c5c7924d33a9874444fdf73d9d
                  expression: 'last(/OLT Huawei/tempportapon[{#OLTPORT}])>(avg(/OLT Huawei/tempportapon[{#OLTPORT}],3h) * 1.5)'
                  name: 'Aumento Temperatura Porta PON {#OLTPORT}'
                  priority: AVERAGE
                  tags:
                    - tag: trigger
                      value: temperatura_porta_gpon
          trigger_prototypes:
            - uuid: 6a1878eca3fc41f18484ca183906e308
              expression: 'last(/OLT Huawei/onuconfigpon[{#OLTPORT}])<(last(/OLT Huawei/pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},2]) * 1.5)'
              name: 'Mais metade ont porta {#OLTPORT} estão off'
              priority: AVERAGE
              tags:
                - tag: trigger
                  value: ont_off_50%
          graph_prototypes:
            - uuid: 416dde3bbbd24e89b3fa0e4bbd8f6ca6
              name: 'Onus ON/OFFLine {#OLTPORT}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'onuconfigpon[{#OLTPORT}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},2]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'pon.sh[{$SNMP_COMMUNITY},{HOST.CONN},{#SNMPINDEX},1]'
            - uuid: 6e834329eeb54582bb21a70dce27cbf2
              name: 'Status porta {#OLTPORT}'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'OltLinktState[{#OLTPORT}]'
            - uuid: 76c6ab4fc76440d3acaa48e72b85818d
              name: 'Temperatura porta {#OLTPORT}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'tempportapon[{#OLTPORT}]'
        - uuid: 29a0feac96a34c9697b93d26e5e48ac0
          name: ONU
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2011.6.128.1.1.2.43.1.9,{#SERIAL},SNMPv2-SMI::enterprises.2011.6.128.1.1.2.43.1.3]'
          key: onudisc
          delay: 10s
          description: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2011.6.128.1.1.2.43.1.9,{#ETHPORT},1.3.6.1.4.1.2011.6.128.1.1.2.62.1.4]'
          item_prototypes:
            - uuid: 1946202fcee14c4399e30b3084dd9731
              name: 'OLT Rx ONT optical power {#SNMPVALUE} ({#SERIAL})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.51.1.6.{#SNMPINDEX}'
              key: 'oltRxontPower[{#SNMPINDEX}]'
              delay: 2m
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              description: 'los ou desligada = -40'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 2147483647 ){
                       value = -40;
                      }
                      else{
                        value = (value - 10000)/100;
                      }
                      return (parseFloat(value));
                - type: IN_RANGE
                  parameters:
                    - '-39'
                    - '0'
                  error_handler: DISCARD_VALUE
              tags:
                - tag: application
                  value: 'OLT Rx ONT optical power'
            - uuid: 7c2d9fc4826245ef9a680835b33d4a07
              name: 'ONT Rx optical power {#SNMPVALUE} ({#SERIAL})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.51.1.4.{#SNMPINDEX}'
              key: 'OntRxPower[{#SNMPINDEX}]'
              delay: 2m
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              description: 'los ou desligada = -40'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
                - type: IN_RANGE
                  parameters:
                    - '-40'
                    - '-5'
                  error_handler: DISCARD_VALUE
              tags:
                - tag: application
                  value: 'ONT Rx optical power'
            - uuid: 0f3bbf74210c4535946e1687fe11f138
              name: 'ONT Status {#SNMPVALUE} ({#SERIAL})'
              type: SNMP_AGENT
              snmp_oid: 'SNMPv2-SMI::enterprises.2011.6.128.1.1.2.46.1.15.{#SNMPINDEX}'
              key: 'Ontstatus[{#SNMPINDEX}]'
              history: 15d
              trends: 35d
              value_type: FLOAT
              description: |
                1 - online
                2 - offline
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '600'
              tags:
                - tag: application
                  value: onu_status
              trigger_prototypes:
                - uuid: 177c50e33aef43d1ba9223f26263d82c
                  expression: 'avg(/OLT Huawei/Ontstatus[{#SNMPINDEX}],48h)>=2 and min(/OLT Huawei/Ontstatus[{#SNMPINDEX}],48h)=1'
                  name: 'Onu OffLine a 2 dias - {#SNMPVALUE} ({#SERIAL})'
                  priority: INFO
                  tags:
                    - tag: trigger
                      value: onu_off_48h
            - uuid: 59f9947663d24a57b0ba47472f90f698
              name: 'ONT Temperatura {#SNMPVALUE} ({#SERIAL})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.51.1.1.{#SNMPINDEX}'
              key: 'Onttemperatura[{#SNMPINDEX}]'
              delay: 5m
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: ºC
              description: '0ºC = desligada'
              preprocessing:
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: application
                  value: onu_temperatura
              trigger_prototypes:
                - uuid: 77c83ca7efb54d20898f9fd5dd5a0d93
                  expression: 'last(/OLT Huawei/Onttemperatura[{#SNMPINDEX}])>(avg(/OLT Huawei/Onttemperatura[{#SNMPINDEX}],3) * 1.5) and count(/OLT Huawei/Onttemperatura[{#SNMPINDEX}],#10)<>0'
                  name: 'Aumento temperatura ONU {#SNMPVALUE} ({#SERIAL})'
                  priority: INFO
                  tags:
                    - tag: trigger
                      value: temperatura_onu
            - uuid: c898874ad1c040febeb43a2eb81e71ac
              name: 'ONT Tx optical power {#SNMPVALUE} ({#SERIAL})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.6.128.1.1.2.51.1.3.{#SNMPINDEX}'
              key: 'OntTxPower[{#SNMPINDEX}]'
              delay: 2m
              history: 15d
              trends: 35d
              value_type: FLOAT
              units: dbm
              description: 'los ou desligada = -40'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
                - type: IN_RANGE
                  parameters:
                    - '-5'
                    - '10'
                  error_handler: DISCARD_VALUE
              tags:
                - tag: application
                  value: 'ONT Tx optical power'
          trigger_prototypes:
            - uuid: 1c208a706eea49fda9b74ac40f79e36f
              expression: 'avg(/OLT Huawei/OntRxPower[{#SNMPINDEX}],30m)<-28 or avg(/OLT Huawei/oltRxontPower[{#SNMPINDEX}],30m)<-30 and last(/OLT Huawei/oltRxontPower[{#SNMPINDEX}])<>-40 and last(/OLT Huawei/OntRxPower[{#SNMPINDEX}])<>-40'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'avg(/OLT Huawei/OntRxPower[{#SNMPINDEX}],30m)<-28 or avg(/OLT Huawei/oltRxontPower[{#SNMPINDEX}],30m)>-28'
              name: 'Sinal Baixo ONU {#SNMPVALUE} ({#SERIAL})'
              priority: WARNING
              tags:
                - tag: trigger
                  value: sinal_baixo_ont
          graph_prototypes:
            - uuid: 14eb2b8a51f84a038ff4b14ccadd0b79
              name: 'ONT Temperatura {#SNMPVALUE} ({#SERIAL})'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'Onttemperatura[{#SNMPINDEX}]'
            - uuid: 89892944f45a4ad6b354b0c409107528
              name: 'Sinal ONT {#SNMPVALUE} ({#SERIAL})'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'oltRxontPower[{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'OntRxPower[{#SNMPINDEX}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  yaxisside: RIGHT
                  calc_fnc: ALL
                  item:
                    host: 'OLT Huawei'
                    key: 'OntTxPower[{#SNMPINDEX}]'
      macros:
        - macro: '{$SNMP_COMMUNITY}'
          value: public
      valuemaps:
        - uuid: 6308643a8e8a4efba86594b03764fcc7
          name: 'Indicates the offline reason of ethernet port.'
          mappings:
            - value: '-1'
              newvalue: invalid
            - value: '1'
              newvalue: unknown
            - value: '2'
              newvalue: boardabnormal
            - value: '3'
              newvalue: opticalmoduleoffline
            - value: '4'
              newvalue: los
            - value: '5'
              newvalue: shutdownbyuser
            - value: '6'
              newvalue: ringdetected
            - value: '7'
              newvalue: ethoamtriggeredlinkdown
            - value: '8'
              newvalue: dyinggasp
        - uuid: 1dca501a48bd4169bed19e22f41dbc19
          name: 'SNMP interface status (ifAdminStatus)'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '3'
              newvalue: testing
        - uuid: fd909016769f4ac9abadd7f8fc8f95b4
          name: 'SNMP interface status (ifOperStatus)'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '3'
              newvalue: testing
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
  graphs:
    - uuid: dffce3c3e5b341a8b32fa55471fe10db
      name: 'Onus ON/OFFLine'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          calc_fnc: ALL
          item:
            host: 'OLT Huawei'
            key: 'total_onu_off.sh[{$SNMP_COMMUNITY},{HOST.CONN},2]'
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: F63100
          calc_fnc: ALL
          item:
            host: 'OLT Huawei'
            key: 'total_onu_on.sh[{$SNMP_COMMUNITY},{HOST.CONN},1]'
